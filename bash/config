#!/bin/sh
# -*- sh -*-

# Colors from http://wiki.archlinux.org/index.php/Color_Bash_Prompt
# Misc
NO_COLOR='\e[0m' #disable any colors
# Regular colors
BLACK='\e[0;30m'
RED='\e[0;31m'
GREEN='\e[0;32m'
YELLOW='\e[0;33m'
BLUE='\e[0;34m'
MAGENTA='\e[0;35m'
CYAN='\e[0;36m'
WHITE='\e[0;37m'
# Emphasized (bolded) colors
EBLACK='\e[1;30m'
ERED='\e[1;31m'
EGREEN='\e[1;32m'
EYELLOW='\e[1;33m'
EBLUE='\e[1;34m'
EMAGENTA='\e[1;35m'
ECYAN='\e[1;36m'
EWHITE='\e[1;37m'
# Underlined colors
UBLACK='\e[4;30m'
URED='\e[4;31m'
UGREEN='\e[4;32m'
UYELLOW='\e[4;33m'
UBLUE='\e[4;34m'
UMAGENTA='\e[4;35m'
UCYAN='\e[4;36m'
UWHITE='\e[4;37m'
# Background colors
BBLACK='\e[40m'
BRED='\e[41m'
BGREEN='\e[42m'
BYELLOW='\e[43m'
BBLUE='\e[44m'
BMAGENTA='\e[45m'
BCYAN='\e[46m'
BWHITE='\e[47m'

# show current directory and working branch for git
function parse_git_branch {
  git branch --no-color 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/\1/'
}

function determine_git_repo {
  [[ ! -z $(parse_git_branch) ]] && echo "[$(parse_git_branch)]"
}

export PS1="\[$EBLACK\]\w\[$MAGENTA\] \$(determine_git_repo)\[$NO_COLOR\] \342\230\205  "

#export PS1="$LIGHT_GREY\u$WHITE:$VIOLET\W$LIGHT_VIOLET\$(determine_git_repo) $DEFAULT$LIGHT_GREY|$VIOLET\j$LIGHT_GREY| <>$DEFAULT "
export PS2='> '

# History
shopt -s histappend

# homebrew bash completion
if [ -f $(brew --prefix)/etc/bash_completion ]; then
  . $(brew --prefix)/etc/bash_completion
fi

# homebrew tabcomplete
source $(brew --repository)/Library/Contributions/brew_bash_completion.sh

# git bash completion
if [ -f etc/git-completion.bash ]; then
  . etc/git-completion.bash
fi

#AWS CLI completion
complete -C aws_completer aws

# Docker
eval "$(docker-machine env default)"

### RUMBLEFISH STUFFS
rfserver ()
{
  ssh -i ~/.ssh/rumblefish-ops-us-west-2.pem 'ubuntu@'$1''
}

hfaserver ()
{
  ssh -i ~/.ssh/hfa-ops.pem 'ubuntu@'$1''
}

# RF servers
lsservers()
{
    echo "FTP:                    ftp.rumblefish.com"
    echo "prod-dataprocessing-02: 10.20.22.231"
    echo "prod-dataprocessing-01: 10.20.21.123"
    echo "prod-megabass-01:       10.20.21.50"
    echo "prod-megabass-slave-01: 10.20.21.114"
    echo "hfa dev:                54.86.198.66"
}

# vamp stuff for Icarus converter
export PATH="$PATH:~/code/fugue/bin"
export VAMP_PATH="~/code/fugue/bin"

# db_models config
export CONFIG_PATH="$HOME/code/fugue/config"
export ENV="prod"

# Fugue path for Vagrant
export FUGUE_PATH="$HOME/code/fugue"

switch_env ()
{
    echo "Switching ENV to $1"
    sed -E -i.tmp 's/export ENV="[a-z_]+"/export ENV="'"$1"'"/' $BASH_SOURCE
    bash
}
